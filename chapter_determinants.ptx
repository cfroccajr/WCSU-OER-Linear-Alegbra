<?xml version="1.0" encoding="UTF-8" ?>

<!--********************************************************************
Copyright 2017 Charles F. Rocca Jr

This file is part of a MathBook XML project.

This project is focused on creating a brief inquiry based text for 
use in a introductory course in cryptology for non-technical students.  
The material is presented, whenever possible, in a historically honest 
manner.

Copyright 2015 Robert A. Beezer

This file is part of MathBook XML.

MathBook XML is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 2 or version 3 of the
License (at your option).

MathBook XML is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with MathBook XML.  If not, see <http://www.gnu.org/licenses/>.
*********************************************************************-->

<chapter xml:id="determinants"  xmlns:xi="http://www.w3.org/2001/XInclude">
    <title>Determinants, Eigenvalues, and Eigenvectors</title>

<!-- Objectives -->
    <objectives>
            <ul>
                <li> Be able to compute determinants.</li>
                <li> Be able to find eigenvalues and eigenvectors for small matrices.</li>
                <li> Understand the relationship between determinants and transformations.</li>
                <li> Use cofactors to find matrix inverses.</li>
                <li> View eigenvectors graphically in relation to transformations.</li>
                <li> See how to use a computer algebra system to help calculate and visualize eigenvectors.</li>
            </ul>
    </objectives>


<!-- Introduction -->

    <introduction>
        <p>
            In this unit we learn about determinants.  Our goal is to understand not only how to calculate determinants but more importantly to understand what determinants tell us about transformations both directly and through the calculation of eigenvectors.
        </p>
    </introduction>

<!-- Determinants -->

    <section xml:id="section_determinants">
        <title>Determinants and their Geometry</title>
        <idx><h>determinant</h></idx>
        <subsection>
            <title>Linear Distortions</title>
            <investigation>
                <title>Distorted Area</title>
                <p>
                    Suppose we form a parallelogram with the vectors <m>\vec{v}=\left\lt3,1\right\gt</m> and <m>\vec{w}=\left\lt1,2\right\gt</m>.  To find the area we need to multiply the length of the base by the height, or (from <xref ref="parallelogram_area"/>) <me>Area = ||\vec{v}||\, ||\vec{w}-proj_{\vec{v}}\vec{w}||.</me>
                    <sidebyside widths="50% 40%">
                        <p>
                            <md>
                                <mrow>\vec{w}-proj_{\vec{v}}\vec{w}\amp=\left\lt1,2\right\gt-\frac{5}{10}\left\lt3,1\right\gt</mrow>
                                <mrow>\amp=\left\lt-\frac{1}{2},\frac{3}{2}\right\gt</mrow>
                            </md>
                            <md>
                                <mrow>||\vec{v}||\, ||\vec{w}-proj_{\vec{v}}\vec{w}||\amp= \left(\sqrt{10}\right)\left(\frac{\sqrt{10}}{2}\right)</mrow>
                                <mrow>\amp = 5</mrow>
                            </md>
                        </p>
                        <figure xml:id="parallelogram_area">
                            <caption>Area of a Parallelogram</caption>
                            <image width="40%" source="images/vector_parallelagram.svg" />
                        </figure>
                    </sidebyside>
                    So, the area of the parallelogram is 5.  Interestingly if we define the transformation
                    <me>
                        T\left(\vec{x}\right)=
                        \left(
                            \begin{array}{rr}
                                3 \amp 1\\
                                1 \amp 2
                            \end{array}
                        \right)\vec{x},
                    </me>
                    which carries the square of area 1 made by the standard basis to this parallelogram, then <me>a_{11}\, a_{22}-a_{12}\, a_{21}=3\cdot2-1\cdot1=5.</me>  This is because given a matrix
                    <me>
                        A=
                        \left(
                            \begin{array}{rr}
                                a_{11} \amp a_{12}\\
                                a_{21} \amp a_{22}
                            \end{array}
                        \right),
                    </me>
                    the value <me>det\, A=a_{11}\, a_{22}-a_{12}\, a_{21}</me> called the <term>determinant of <m>A</m></term><idx><h>determinant</h></idx> measures how much <m>A</m> distorts <m>\mathbb{R}^2</m> if we think of it as a transformation.
                </p>
            </investigation>
            <investigation>
                <title>Distorted Volume</title>
                <sidebyside>
                    <p>
                        Suppose we have a parallelepiped as in the figure, for simplicity assume the base is a rectangle.  The the volume will be area of the base times the height.  The area of the base is easy, <m>Area=||\vec{v}||\, ||\vec{w}||</m>.  To get the height we need to use projections, in particular:
                        <me>
                            ||\vec{u}-proj_{\vec{v}}\vec{u}-proj_{\vec{w}}\vec{u}||.
                        </me>
                    </p>
                    <figure>
                        <caption>Volume of a Parallelepiped</caption>
                        <image width="40%" source="images/vector_parallelpiped.svg" />
                    </figure>
                </sidebyside>
                <p>
                    <md>
                        <mrow>
                            ||\vec{u}-proj_{\vec{v}}\vec{u}-proj_{\vec{w}}\vec{u}||\amp=\left|\left|\vec{u}-\frac{u_1v_1+u_2v_2+u_3v_3}{||\vec{v}||^2}\vec{v}-\frac{u_1w_1+u_2w_2+u_3w_3}{||\vec{w}||^2}\vec{v}\right|\right|
                        </mrow>
                        <mrow>
                            \amp=\left|\left|\left\lt u_1,u_2,u_3\right\gt-\frac{u_1v_1+u_2v_2+u_3v_3}{||\vec{v}||^2}\left\lt v_1,v_2,v_3\right\gt-\frac{u_1w_1+u_2w_2+u_3w_3}{||\vec{w}||^2}\left\lt w_1,w_2,w_3\right\gt\right|\right|
                        </mrow>
                        <mrow>
                            \amp \vdots
                        </mrow>
                        <mrow>
                             \mbox{Then A}\ \amp \mbox{Miracle Occurs}
                        </mrow>
                        <mrow>
                            \amp \vdots
                        </mrow>
                        <mrow>
                            \amp = \frac{|v_1(u_2w_3-w_2u_3)-v_2(u_1w_3-w_1u_3)+v_3(u_1w_2-w_1u_2)|}{||\vec{v}||\, ||\vec{w}||}
                        </mrow>
                    </md>
                    So, that the magnitude will be
                    <me>|v_1(u_2w_3-w_2u_3)-v_2(u_1w_3-w_1u_3)+v_3(u_1w_2-w_1u_2)|,</me> 
                    the expression inside the absolute value is the determinant of the matrix
                    <me>
                        \left(
                            \begin{array}{lll}
                                v_1 \amp u_1 \amp w_1\\
                                v_2 \amp u_2 \amp w_2\\
                                v_3 \amp u_3 \amp w_3\\
                            \end{array}
                        \right)
                    </me>
                    which transforms the vectors of the standard basis into the vectors <m>\vec{v}</m>, <m>\vec{w}</m>, and <m>\vec{u}</m>.
                </p>
            </investigation>
        </subsection>
        <subsection>
            <title>Calculating Determinants (Laplace's Formula)</title>
            <investigation>
                <title>Two-By-Two</title>
                <p>
                    Consider the matrix...
                </p>
            </investigation>
        </subsection>
        <subsection>
            <title>Properties of Determinants</title>
            <p>
                Some Content!!!
            </p>
        </subsection>
    </section>

<!-- Similar Matrices -->

    <section xml:id="section_similarity">
        <title>Matrix Equivalence and Similarity</title>
        <subsection>
            <title>Change of Bases and Transformations</title>
            <p>
                Recall that if <m>\mathcal{B}</m> is one basis for a vector space and <m>\mathcal{D}</m> is another, then the transformations <m>Rep_{\mathcal{B}\mathcal{D}}</m> and <m>Rep_{\mathcal{D}\mathcal{B}}</m> change coordinates back and forth between them, and that <m>(Rep_{\mathcal{D}\mathcal{B}})^{-1}=Rep_{\mathcal{B}\mathcal{D}}</m>. (See also <xref ref="bases_change"/> and <xref ref="bases_transform_change"/>.)
                <sidebyside>
                    <p>
                        If <m>T</m> is a transformation of the vector space in terms of the basis <m>\mathcal{B}</m>, then
                        <md>
                            <mrow>
                                \widehat{T}\amp=Rep_{\mathcal{D}\mathcal{B}}\circ T\circ Rep_{\mathcal{B}\mathcal{D}}
                            </mrow>
                            <mrow>
                                \amp=Rep_{\mathcal{D}\mathcal{B}}\circ T\circ (Rep_{\mathcal{D}\mathcal{B}})^{-1},
                            </mrow>
                        </md>
                        is the same transformation except in terms of <m>\mathcal{D}</m>.
                        <fn>
                            Why is the composition of the transformations written right to left?
                        </fn>
                        When this situation exists we say that the transformations <m>T</m> and <m>\widehat{T}</m> are <term>similar</term><idx><h>similar</h></idx> (or in some settings we say they are <term>conjugate</term><idx><h>conjugate</h></idx>).
                    </p>
                    <figure xml:id="basis_and_transformations">
                        <caption>Transformations Between and Within Bases</caption>
                        <image width="50%" source="images/basis_commuting_diagram.png" />
                    </figure>
                </sidebyside>
                In your text
                (<url href="http://joshua.smcvt.edu/linearalgebra/book.pdf#page=269">map representations, p.259</url> and <url href="http://joshua.smcvt.edu/linearalgebra/book.pdf#page=398">similarity, p.388</url>) you will see this written something like:
                    <me>T=Rep_{\mathcal{B}\mathcal{B}}\left(T\right)</me>
                and
                    <md>
                        <mrow>\widehat{T}\amp=Rep_{\mathcal{D}\mathcal{D}}\left(T\right)</mrow>
                        <mrow>\amp=Rep_{\mathcal{D}\mathcal{B}}\circ T\circ (Rep_{\mathcal{D}\mathcal{B}})^{-1}</mrow>
                        <mrow>\amp=Rep_{\mathcal{D}\mathcal{B}}\circ Rep_{\mathcal{B}\mathcal{B}}\left(T\right)\circ (Rep_{\mathcal{D}\mathcal{B}})^{-1}.</mrow>
                    </md>
            </p>
        </subsection>
        <subsection>
            <title>Similar Matrices</title>
            <definition>
                <title>
                    Similar Matrices<idx><h>similar matrices</h></idx>
                </title>
                <statement>
                    <p>
                        Two matrices <m>A</m> and <m>B</m> are said to be <term>similar</term> if there exists an invertible (non-singular) matrix <m>P</m> such that
                        <me>B=P\, A\, P^{-1}.</me>
                        More generally, we say that two elements related in this way are <term>conjugates</term><idx><h>conjugate</h></idx>.
                    </p>
                </statement>
            </definition>
            <investigation>
                <title>A Basic Example</title>
                <p>
                    Suppose we have two matrices
                    <me>
                        A=
                        \left(
                            \begin{array}{rr}
                                1\amp 3 \\ -1 \amp-2\\
                            \end{array}
                        \right),\ \mbox{and}\ 
                        B=
                        \left(
                            \begin{array}{rr}
                                -10 \amp 7 \\
                                -13 \amp 9
                            \end{array}
                        \right)
                    </me>
                    and we want to see if they are similar.  By <alert>definition</alert> this means we need to find <m>P</m> such that
                    <me>A=P\, B\, P^-1</me>
                    or equivalently
                    <me>A\, P=P\, B.</me>
                    Let
                    <me>
                        P=
                        \left(
                            \begin{array}{rr}
                                p_1 \amp p_2\\
                                p_3 \amp p_4
                            \end{array}
                        \right)
                    </me>
                    so that the equation above becomes
                    <me>
                        \left(
                            \begin{array}{rr}
                                p_1+3p_3\amp p_2+3p_4 \\ 
                                -p_1-2p_3 \amp -p_2-2p_4\\
                            \end{array}
                        \right)=
                        \left(
                            \begin{array}{rr}
                                -10p_1-13p_2\amp 7p_1+9p_2 \\
                                -10p_3-13p_4\amp 7p_3+9p_4 \\
                            \end{array}
                        \right)                                                
                    </me>
                    leaving us with four equations and four unknowns.
                    Here we write it as a homogeneous system:
                    <md>
                        <mrow>11p_1+13p_2+3p_3\amp = 0</mrow>
                        <mrow>7p_1+8p_2-3p_4\amp = 0</mrow>
                        <mrow>p_1-8p_3-13p_4\amp = 0</mrow>
                        <mrow>p_2+7p_3+11p_4\amp = 0</mrow>
                    </md>
                    or as a matrix equation
                    <me>
                        \left(
                            \begin{array}{rrrr|r}
                                11 \amp 13 \amp 3 \amp 0 \amp 0\\
                                7 \amp 8 \amp 0 \amp -3 \amp 0\\
                                1 \amp 0 \amp -8 \amp -13 \amp 0\\
                                0 \amp 1 \amp 7 \amp 11 \amp 0\\
                            \end{array}
                        \right).
                    </me>
                    With a little work this reduces to
                    <me>
                        \left(\begin{array}{rrrr|r}
                            1 \amp 0 \amp -8 \amp -13 \amp 0\\
                            0 \amp 1 \amp 7 \amp 11 \amp 0\\
                            0 \amp 0 \amp 0 \amp 0 \amp 0\\
                            0 \amp 0 \amp 0 \amp 0 \amp 0
                        \end{array}\right).
                    </me>
                    So if we let <m>p_3=-1</m> and <m>p_4=1</m> we get <m>p_1=5</m> and <m>p_2=-4</m>, and
                    <me>
                        P=
                        \left(
                            \begin{array}{rr}
                                5 \amp -4\\
                                1 \amp -1
                            \end{array}
                        \right).
                    </me>
                    Note that since <m>p_3</m> and <m>p_4</m> are free variables there are in fact infinitely many solutions. Finally, we will see in <xref ref="section_diagonal"/> that there is an easier way.
                </p>
            </investigation>
        </subsection>
        <conclusion>
            <p>
                Here are some basic key observations:
            </p>
            <theorem xml:id="similar_properties">
                <title>Basic Properties of Similar Matrices</title>
                <statement>
                    <p>
                        If the matrices <m>A</m> and <m>B</m> are similar, then
                        <ul>
                            <li><m>\exists\ P:\ A=P\, B\, P^{-1}</m></li>
                            <li><m>\exists\ P:\ A^n=P\, B^n\, P^{-1}</m></li>
                            <li><m>det(A)=det(B)</m></li>
                            <li><m>A</m> is invertible if and only if <m>B</m> is also invertible</li>
                            <li><m>A=I</m> if and only if <m>B=I</m></li>
                            <li><m>A=0</m> if and only if <m>B=0</m></li>
                        </ul>
                    </p>
                </statement>
            </theorem>
        </conclusion>
    </section>

<!-- Eigenvalues and Vectors -->

    <section xml:id="section_eigen">
        <title>Eigenvalues and Eigenvectors</title>
        <p>
            Some Content!!!
        </p>
    </section>

<!-- Diagonalizable -->

    <section xml:id="section_diagonal">
        <title>Diagonalizable Matrices</title>
        <p>
            Some Content!!!
        </p>
    </section>

<!-- CAS and Eigenvalues -->

    <section xml:id="section_CAS_eigen">
        <title>CAS - Visualizing Eigenvectors</title>
        <p>
            <url href="http://joshua.smcvt.edu/linearalgebra/lab.pdf">Sage Lab Manual</url> Some Content!!!
        </p>
        <p>Hill Cipher Cell</p>
        <sage>
            <input><xi:include href="sage_code/sample_sage.sage" parse="text" /></input>
            <output></output>
        </sage>

    </section>

<!-- CAS and Models -->

    <section xml:id="section_CAS_models">
        <title>CAS - Modeling with Matrices</title>
        <p>
            <url href="http://joshua.smcvt.edu/linearalgebra/lab.pdf">Sage Lab Manual</url> Some Content!!!
        </p>
        <p>Hill Cipher Cell</p>
        <sage>
            <input><xi:include href="sage_code/sample_sage.sage" parse="text" /></input>
            <output></output>
        </sage>


    </section>

<!-- Supplementary Material -->

    <section xml:id="section_supplement_determinants">
        <title>Supplementary Material</title>
            <figure>
                    <!-- <title>Modern Marvels: Codes</title> -->
                    <caption>Gaussian Elimination</caption>
                    <video youtube="qbWDZM4qgEk" />
            </figure>
    </section>


<!-- Exercises -->

    <exercises xml:id="section_exercises_determinants">
        <title>Homework Exercises on Determinants</title>
        <introduction>
            <p>
                <alert>Homework Exercises:</alert>
            </p>
            <p>
                These exercises are here to check your deeper conceptual understanding of the material and your ability to problem solve; they are not skill drills.  As such they are for homework and not test preparation, they would be far to long for an exam.  You need to complete each problem to the best of your ability.  Every answer you give needs to be your own work, needs to be written neatly on lined paper or typed, and at least the final answer for each should be a complete sentence.  Do not include a copy of the question with your solution, that is not needed to convey your thoughts clearly.
            </p>
            <p>
            </p>
        </introduction>
        <exercise>
            <statement>
                <p>
                    Stuff!!!
                </p>
            </statement>
            <hint>
                <p>
                    Stuff!!!
                </p>
            </hint>
        </exercise>
    </exercises>


    <exercises xml:id="section_practice_exam_determinants">
        <title>Practice Exam on Linear Transformations</title>
        <introduction>
            <p>
                Here are some exercises from the <url href="http://joshua.smcvt.edu/linearalgebra/book.pdf">Hefferon's text</url> which you should try, the answers to all of these can be found in the <url href="http://joshua.smcvt.edu/linearalgebra/jhanswer.pdf"><em>Answers to Exercises</em></url> supplement for Hefferon's text.  You do not need to hand in these exercises.
                <ul>
                    <li> <m>\S</m> - <url href="http://joshua.smcvt.edu/linearalgebra/book.pdf#page=331">Definition of Determinants (p.321): 1, 2, 4, 5, 6</url> </li>
                    <li> <m>\S</m> - <url href="http://joshua.smcvt.edu/linearalgebra/book.pdf#page=367">Laplace's Expansion (p.357): 11, 13, 14, 19</url> </li>
                    <li> <m>\S</m> - <url href="http://joshua.smcvt.edu/linearalgebra/book.pdf#page=336">Properties of Determinants (p.326): 8, 9, 10</url> </li>
                    <li> <m>\S</m> - <url href="http://joshua.smcvt.edu/linearalgebra/book.pdf#page=360">Determinants as Size Functions (p.350): 9, 11, 12, 14</url> </li>
                    <li> <m>\S</m> - <url href="http://joshua.smcvt.edu/linearalgebra/book.pdf#page=401">Definition of Similarity (p.391): 5</url> </li>
                    <li> <m>\S</m> - <url href="http://joshua.smcvt.edu/linearalgebra/book.pdf#page=415">Eigenvalues and Eigenvectors (p.405): 22, 23, 24, 25, 26</url> </li>
                    <li> <m>\S</m> - <url href="http://joshua.smcvt.edu/linearalgebra/book.pdf#page=406">Diagonalizability (p.396): 7,15</url> </li>
                </ul>
                Additionally, be sure you can define the following: Determinants, Cofactors, Minor Matrix, Eigenvector, Eigenvalue, Characteristic Polynomial, Similar Matrices, Diagonalizable, Singular, Non-Singular
            </p>
        </introduction>
        <exercisegroup>
            <introduction>
                <p>
                    <alert>Practice Exam:</alert>
                </p>
                <p>
                    In addition to the practice problems above below are the questions for your practice exam, these must be turned in when you come in for the exam.  The practice exam counts for 5% of your exam grade and can earn you back 15% of any points you loose on the in-class portion of the exam.
                </p>
            </introduction>
            <exercise>
                <statement>
                    <p>
                        Define <term>Minor Matrix <m>A_{ij}</m></term>.
                    </p>
                </statement>
            </exercise>

            <exercise>
                <statement>
                    <p>
                        Define <term>Eigenvector</term>.
                    </p>
                </statement>
            </exercise>

            <exercise>
                <statement>
                    <p>
                        Define <term>Characteristic Polynomial</term>.
                    </p>
                </statement>
            </exercise>

            <exercise>
                <statement>
                    <p>
                        Define <term>Similar Matrices</term>.
                    </p>
                </statement>
            </exercise>

            <exercise>
                <statement>
                    <p>
                        Given that <m>C</m> and <m>D</m> are <m>n\times n</m> matrices, that <m>det(C)=4</m>, and that <m>det(D)=-7</m> find the value of
                        <me>
                            det\left(
                                5\, C^2\, D^{-1}
                            \right).
                        </me>
                    </p>
                </statement>
                <hint>
                    <p>
                        Your answer will be in terms of <m>n</m>.
                    </p>
                </hint>
            </exercise>

            <exercise>
                <statement>
                    <p>
                        Suppose that <m>T</m> and <m>R</m> are similar matrices and that <m>det\left(T\right)=9</m> what is the determinant of <m>R</m>, and why.
                    </p>
                </statement>
                <hint>
                    <p>
                        You will need to use the definition of similar matrices.
                    </p>
                </hint>
            </exercise>


            <exercise>
                <statement>
                    <p>
                      Show that the determinant of the matrix
                      <me>
                          A=\left[
                            \begin{array}{rrr}
                                2 \amp 0 \amp 8\\
                                0 \amp 3 \amp 2\\
                                7 \amp 4 \amp 9
                            \end{array}
                          \right]
                      </me>
                      is equal to -130 by expanding down the first column.
                    </p>
                </statement>
            </exercise>

            <exercise>
                <statement>
                    <p>
                      Show that the determinant of the matrix
                      <me>
                          A=\left[
                            \begin{array}{rrr}
                                2 \amp 0 \amp 8\\
                                0 \amp 3 \amp 2\\
                                7 \amp 4 \amp 9
                            \end{array}
                          \right]
                      </me>
                      is equal to -130 by expanding along the second row.
                    </p>
                </statement>
            </exercise>


            <exercise>
                <statement>
                    <p>
                      Show that the determinant of the matrix
                      <me>
                          A=\left[
                            \begin{array}{rrr}
                                2 \amp 0 \amp 8\\
                                0 \amp 3 \amp 2\\
                                7 \amp 4 \amp 9
                            \end{array}
                          \right]
                      </me>
                      is equal to -130 by first reducing it to row echelon form.
                    </p>
                </statement>
            </exercise>

            <exercise>
                <statement>
                    <p>
                        Find the eigenvalues of the matrix
                        <me>
                            B=\left[
                                \begin{array}{rr}
                                    1 \amp 1\\
                                    2 \amp 0\\
                                \end{array}
                            \right],
                        </me>
                        you should get <m>\lambda_1=2</m> and <m>\lambda_2=-1</m>.
                    </p>
                </statement>
                <hint>
                    <p>
                        First find the characteristic polynomial for <m>B</m>.
                    </p>
                </hint>
            </exercise>


            <exercise>
                <statement>
                    <p>
                        Find the eigenvectors of the matrix
                        <me>
                            B=\left[
                                \begin{array}{rr}
                                    1 \amp 1\\
                                    2 \amp 0\\
                                \end{array}
                            \right],
                        </me>
                        you should get <m>\vec{v}_1=\left\lt1,1\right\gt</m> and <m>\vec{v}_2=\left\lt1,-2\right\gt</m>.
                    </p>
                </statement>
                <hint>
                    <p>
                        Use the results from the previous problem and solve the equations <m>B\vec{v}_i=\lambda_i\vec{v}_i</m>.
                    </p>
                </hint>
            </exercise>


            <exercise>
                <statement>
                    <p>
                        Find matrices <m>P</m> and <m>D</m> such that <m>B=P\, D\, P^{-1}</m> where
                        <me>
                            B=\left[
                                \begin{array}{rr}
                                    1 \amp 1\\
                                    2 \amp 0\\
                                \end{array}
                            \right],
                        </me>
                        and <m>D</m> is a diagonal matrix.
                    </p>
                </statement>
                <hint>
                    <p>
                        Use the information from the previous two problems.
                    </p>
                </hint>
            </exercise>


        </exercisegroup>
    </exercises>

</chapter>

